{% extends "base.html" %}

{% block content %}

<div class="p-6 bg-white rounded shadow">
  <div class="flex flex-col md:flex-row justify-between items-center mb-4">
    <h1 class="text-2xl font-bold">👨‍💼 Employee List</h1>
    
    <form method="get" class="mt-4 md:mt-0 flex">
      <input type="text" name="q" value="{{ query }}" placeholder="🔍 Search by name, ID, or Device ID"
             class="border border-gray-300 px-3 py-2 rounded-l focus:outline-none focus:ring-2 focus:ring-blue-500"
             style="min-width: 290px;">
      
    </form>
  </div>

  <div class="mb-4">
    <a href="{% url 'employee_add' %}" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 inline-block">
      ➕ Add Employee
    </a>
  </div>

  <div class="overflow-x-auto">
    <table class="table-auto w-full border border-gray-300 text-sm">
      <thead class="bg-gray-100">
        <tr>
          <th class="border px-4 py-2">🆔 ID</th>
          <th class="border px-4 py-2">👤 Name</th>
          <th class="border px-4 py-2">🔢 Device User ID</th>
          <th class="border px-4 py-2">🏢 Department</th>
          <th class="border px-4 py-2">📄 Details</th>
          <th class="border px-4 py-2">✏️ Edit</th>
          <th class="border px-4 py-2">🗑️ Delete</th>
        </tr>
      </thead>
      <tbody>
        {% for emp in employees %}
        <tr class="hover:bg-gray-50">
          <td class="border px-4 py-2 text-center">{{ emp.id }}</td>
          <td class="border px-4 py-2">{{ emp.name }}</td>
          <td class="border px-4 py-2 text-center">{{ emp.device_user_id }}</td>
          <td class="border px-4 py-2 text-center">
            {{ emp.department.name|default:"-" }}
          </td>

          <!-- Details -->
          <td class="border px-4 py-2 text-center">
            <a href="{% url 'employee_attendance_detail' emp.id %}" class="text-indigo-600 hover:underline inline-flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              View
            </a>
          </td>

          <!-- Edit -->
          <td class="border px-4 py-2 text-center">
            <a href="{% url 'employee_edit' emp.id %}" class="text-blue-600 hover:underline inline-flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M15.232 5.232l3.536 3.536M9 11l6 6M4 20h4l10-10a2.828 2.828 0 00-4-4L4 16v4z"/>
              </svg>
              Edit
            </a>
          </td>

          <!-- Delete -->
          <td class="border px-4 py-2 text-center">
            <a href="{% url 'employee_delete' emp.id %}" class="text-red-600 hover:underline inline-flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3m5 0H6"/>
              </svg>
              Delete
            </a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="7" class="text-center py-4 text-gray-500">😔 No employees found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}


{% block extra_scripts %}
<script>
document.addEventListener("DOMContentLoaded", function() {
    const input = document.querySelector('input[name="q"]');
    const rows = document.querySelectorAll("tbody tr");

    input.addEventListener("input", function() {
        const query = input.value.toLowerCase();

        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(query) ? "" : "none";
        });
    });
});
</script>
{% endblock %}

